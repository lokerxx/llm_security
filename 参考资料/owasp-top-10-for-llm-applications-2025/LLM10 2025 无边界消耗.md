# LLM10:2025 无边界消耗

## 描述

无边界消耗（Unbounded Consumption）指的是当一个大语言模型（LLM）应用程序允许用户进行过多或不受控制的推理时可能导致的各种风险。这些风险包括拒绝服务（DoS）、经济损失、模型盗窃以及服务性能下降。由于LLM具有高计算需求，尤其是在云环境中，这种漏洞容易被利用来滥用资源或实施未经授权的使用。

---

## 常见漏洞示例

1. **可变长度输入泛滥**  
   攻击者使用多种长度的输入来超载LLM，利用处理效率的漏洞。这可能耗尽资源，导致系统不可响应，并严重影响服务可用性。

2. **钱包拒绝服务（Denial of Wallet, DoW）**  
   攻击者发起大量操作，利用按使用付费的云服务模式，给服务提供商造成难以承受的财务负担。

3. **持续输入溢出**  
   持续发送超过LLM上下文窗口限制的输入，导致过度的计算资源使用，引发服务性能下降和运营中断。

4. **资源密集型查询**  
   提交异常复杂的查询（如复杂序列或精密语言模式），消耗系统资源，导致处理时间延长和潜在系统故障。

5. **通过API进行模型提取**  
   攻击者使用精心设计的输入和提示注入技术，收集足够的输出以部分复制模型或创建影子模型，从而导致知识产权被盗。

6. **功能性模型复制**  
   利用目标模型生成合成训练数据，攻击者可以微调另一个基础模型，创建功能等价物，从而规避传统的查询提取方法。

7. **旁道攻击**  
   恶意攻击者可能利用LLM的输入过滤技术实施旁道攻击，提取模型权重和架构信息，进一步威胁模型安全。

---

## 预防与缓解策略

1. **输入验证**  
   实施严格的输入验证，确保输入不会超过合理的大小限制。

2. **限制`logits`和`logprobs`的暴露**  
   限制或混淆API响应中`logit_bias`和`logprobs`的暴露，仅提供必要信息。

3. **速率限制**  
   应用速率限制和用户配额，限制单一实体在给定时间段内的请求数量。

4. **资源分配管理**  
   动态监控和管理资源分配，防止单一用户或请求消耗过多资源。

5. **超时和节流**  
   为资源密集型操作设置超时并实施节流，防止资源长期占用。

6. **沙盒技术**  
   限制LLM对网络资源、内部服务和API的访问，以减轻旁道攻击风险。

7. **日志记录、监控和异常检测**  
   持续监控资源使用情况，通过日志记录检测和响应异常资源消耗模式。

8. **水印技术**  
   实施水印框架，以嵌入和检测LLM输出的未经授权使用。

9. **渐进式降级**  
   设计系统在高负载下逐步降级，而不是完全失败，保持部分功能。

10. **限制排队操作并实现动态扩展**  
      限制排队和总操作数量，同时结合动态扩展和负载平衡，以应对不同需求并保持一致的系统性能。

11. **对抗性鲁棒性训练**  
      训练模型检测并缓解对抗性查询和提取尝试。

12. **故障令牌过滤**  
      建立已知故障令牌列表，并在将输出添加到模型上下文窗口之前扫描输出。

13. **访问控制**  
      实施强大的访问控制，包括基于角色的访问控制（RBAC）和最小权限原则，以限制对LLM模型库和训练环境的未经授权访问。

14. **集中式ML模型清单**  
      使用集中式ML模型清单或注册表管理生产环境中使用的模型，确保适当的治理和访问控制。

15. **自动化MLOps部署**  
      通过治理、跟踪和审批工作流实现自动化MLOps部署，强化基础设施内的访问和部署控制。

---

## 示例攻击场景

### **场景 #1: 无限制输入大小**  
攻击者提交异常大的输入给处理文本数据的LLM应用程序，导致过度的内存和CPU使用，可能使系统崩溃或显著减慢服务速度。

### **场景 #2: 重复请求**  
攻击者向LLM API发送大量请求，导致过度的计算资源消耗，使服务无法对合法用户可用。

### **场景 #3: 资源密集型查询**  
攻击者设计特定输入，触发LLM最耗资源的计算过程，导致CPU长期占用和潜在系统故障。

### **场景 #4: 钱包拒绝服务（DoW）**  
攻击者生成大量操作，利用云服务按使用付费模式，造成服务提供商难以承受的成本。

### **场景 #5: 功能性模型复制**  
攻击者使用LLM的API生成合成训练数据，微调另一个模型，从而创建功能等价物并规避传统的模型提取限制。

### **场景 #6: 绕过系统输入过滤**  
恶意攻击者绕过LLM的输入过滤技术和预设，实施旁道攻击并将模型信息传输到其控制的远程资源。